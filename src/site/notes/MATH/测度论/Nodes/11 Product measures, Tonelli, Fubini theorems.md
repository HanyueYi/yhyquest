---
{"dg-publish":true,"permalink":"/MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems/","dgPassFrontmatter":true}
---


> [!definition] product measure
> Let $(X, \mathcal{A})$ and $(Y, \mathcal{B})$ be measurable spaces, and, let $X \times Y$ be the Cartesian product of the sets $X$ and $Y$. A subset of $X \times Y$ is a measurable rectangle if it has the form $A \times B$ for some $A \in \mathcal{A}$ and some $B \in \mathcal{B}$; the $\sigma$-algebra on $X \times Y$ generated by the collection of all measurable rectangles is called the product of the $\sigma$-algebras $\mathcal{A}$ and $\mathcal{B}$ and is denoted by $\mathcal{A} \otimes \mathcal{B}$.

> [!lemma]
> Let $(X, \mathcal{A})$ and $(Y, \mathcal{B})$ be measurable spaces.
> - If $E$ is a subset of $X \times Y$ that belongs to $\mathcal{A} \otimes \mathcal{B}$, then each section $E_x$ belongs to $\mathcal{B}$ and each section $E^y$ belongs to $\mathcal{A}$.
> - If $f$ is an extended real-valued (or a complex-valued) $A \otimes B$-measurable function on $X \times Y$, then each section $f_x$ is $\mathcal{B}$-measurable and each section $f^y$ is $\mathcal{A}$-measurable.

`\begin{proof}`
See [[Measure  Theory    (Xia).pdf#page=78&selection=454,0,455,1|here]]. It is similar as the proof in [[MATH/测度论/Nodes/3 the Monotone Class Theorem\|3 the Monotone Class Theorem]].
`\end{proof}`


> [!lemma]
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be **$\sigma$-finite** measure spaces. If $E \in \mathcal{A} \otimes \mathcal{B}$, then the function $x \rightarrow \nu\left(E_x\right)$ is $\mathcal{A}$-measurable and the function $y \rightarrow$ $\mu\left(E^y\right)$ is $\mathcal{B}$-measurable.
{ #db74fa}


`\begin{proof}`
See [[Measure  Theory    (Xia).pdf#page=78&selection=724,0,724,6|here]]. It is also similar as the proof in [[MATH/测度论/Nodes/3 the Monotone Class Theorem\|3 the Monotone Class Theorem]].
`\end{proof}`


> [!theorem]
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be **$\sigma$-finite** measure spaces. Then there is a unique measure $\mu \times \nu$ on the $\sigma$-algebra $\mathcal{A} \otimes \mathcal{B}$ such that $(\mu \times \nu)(A \times B)=$ $\mu(A) \nu(B)$ holds for each $A \in \mathcal{A}$ and $B \in \mathcal{B}$. Furthermore, for any $E \in \mathcal{A} \otimes \mathcal{B}$, we have
> 
> $$
> (\mu \times \nu)(E)=\int_X \nu\left(E_x\right) d \mu=\int_Y \mu\left(E^y\right) d \nu
> $$
> 
> 
> The measure $\mu \times \nu$ is called the product of $\mu$ and $\nu$.
{ #b32528}


`\begin{proof}`
We define $(\mu\times\nu)_1:=\int_X\nu(E_x)d\mu$ and $(\mu\times\nu)_2:=\int_Y\mu(E^y)d\nu$. Then it suffices to show:
- $(\mu\times\nu)_i$ are measures;
- these two measures coincide on all measurable rectangles;
- the set of measurable rectangles form a $\pi$-system;
- use [[MATH/测度论/Nodes/3 the Monotone Class Theorem#^ljjfjj\|3 the Monotone Class Theorem#^ljjfjj]].

Also see [[Measure  Theory    (Xia).pdf#page=79&selection=355,0,356,1|here]]. 
`\end{proof}`


> [!theorem] Tonelli's Theorem
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be **$\sigma$-finite** measure spaces, and let $f: X \times Y \rightarrow[0, \infty]$ be $\mathcal{A} \otimes \mathcal{B}$-measurable. Then
> - the function $x \rightarrow \int_Y f_x d \nu$ is $\mathcal{A}$-measurable and the function $y \rightarrow \int_X f^y d \mu$ is $\mathcal{B}$-measurable, and
> - $f$ satisfies
> 
> $$\int_{X \times Y} f d(\mu \times \nu)=\int_X\left(\int_Y f_x d \nu\right) d \mu=\int_Y\left(\int_X f^y d \mu\right) d \nu .$$
> 
> 
> Note that the functions $f_x$ and $f^y$ are nonnegative and measurable; thus the expression $\int_Y f_x d \nu$ is defined for each $x$ in $X$ and the expression $\int_X f^y d \mu$ is defined for each $y \in Y$.
{ #67db20}


`\begin{proof}`
It suffices to show these statements hold for character functions by [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^db74fa\|#^db74fa]] and [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^b32528\|#^b32528]] and so for simple function. Then use simple function to approximate measurable function and by MCT we finish the proof. 

Also see [[Measure  Theory    (Xia).pdf#page=80&selection=115,0,116,1|here]]. 
`\end{proof}`


> [!theorem] Fubini's Theorem
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be **$\sigma$-finite** measure spaces, and let $f: X \times Y \rightarrow[-\infty, \infty]$ be $\mathcal{A} \otimes \mathcal{B}$-measurable and $\int_{X \times Y}|f| d(\mu \times \nu)<\infty$. Then
> 
> $$\begin{aligned}&\int_Y|f(x, y)| d \nu<\infty \text { for a.e. } x \in X,\\ &\int_X|f(x, y)| d \mu<\infty \text { for a.e. } y \in Y.\end{aligned}$$
> 
> Furthermore, $x \rightarrow \int_Y f(x, y) d \nu$ is an $\mathcal{A}$-measurable function on $X$ and $y \rightarrow \int_X f(x, y) d \mu$ is a $\mathcal{B}$-measurable function on $Y$, and
> 
> $$\int_{X \times Y} f d(\mu \times \nu)=\int_X\left(\int_Y f_x d \nu\right) d \mu=\int_Y\left(\int_X f^y d \mu\right) d \nu.$$

`\begin{proof}`
By $\int_{X\times Y}|f|<\infty$, we have $\int_Y|f|$, $\int_X|f|$, $\int_Y f_x^+$, $\int_Y f_x^-$ are finite almost everywhere. Then use [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^67db20\|#^67db20]]. 

Also see [[Measure  Theory    (Xia).pdf#page=81&selection=104,0,105,0|here]].
`\end{proof}`


**Remark.** $\mathcal{A},\mathcal{B}$ being $\sigma$-finite is necessary. As a counterexample, consider Lebesgue measure $(\mathbb{R},\mathcal{A},\mu)$, counting measure $(\mathbb{R},\mathcal{B},\nu)$ and $f(x,y)=\delta_{xy}$ with $0\leqslant x\leqslant 1$. 

**Remark of the remark above.** 这一节几乎所有结果都需要 $\sigma$-finite，主要是因为我们需要 $\nu(E_x)$ 和 $\mu(E^y)$ 可测来定义 $\mu\times \nu$ 上的积分, which is defined as $\int_{X \times Y} f d(\mu \times \nu)=\int_X\left(\int_Y f_x d \nu\right) d \mu$. 
- [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^db74fa\|#^db74fa]]
	- we prove the finite measure case and then the $\sigma$-finite case;
	- it ensures that $\nu(E_x)$ and $\mu(E^y)$ are measurable sets, which is important for [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^b32528\|#^b32528]].
- [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^b32528\|#^b32528]] is a proof of Tonelli's theorem for character functions. Only with this conclusion, Tonelli's theorem holds for simple functions and so measurable functions.


> [!note] Example
> Assume that $f:X\to [0,\infty]$ is an $\mathcal{A}$-measurable function. We have the often useful relation 
> 
> $$\int_X f d \mu=\int_0^{\infty} \mu(\{x \in X: f(x)>t\}) d t .$$
> 
> `\begin{proof}`
> Define $E=\{(x,t):0\leqslant t<f(x)\}$, which is the region under the graph of $f$. Since $f$ is measurable, there exists $s_n\uparrow f$ and $E_{s_n}=\{(x.t):0\leqslant t<s_n(x)\}$ is measurable. Then we can compute $\mu\times m(E)$ by [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^67db20\|#^67db20]]. Also see [[Measure  Theory    (Xia).pdf#page=81&selection=361,0,362,0|here]].
> `\end{proof}`

> [!theorem]
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be $\sigma$-finite measure spaces, and let $K$ be a $\mathcal{A} \otimes \mathcal{B}$-measurable function on $X \times Y$. Suppose that there exists $C>0$ such that $\int_X|K(x, y)| d \mu \leqslant C$ for a.e. $y \in Y$ and $\int_Y|K(x, y)| d \nu \leqslant C$ for a.e. $x \in X$, and that $1<p<\infty$. If $f \in L^p(\nu)$, the integral
>
>$$(T f)(x)=\int_Y K(x, y) f(y) d \nu$$
>
> converges absolutely for a.e. $x \in X$, the function $T f$ thus defined is in $L^p(\mu)$, and $\|T f\|_p \leqslant C\|f\|_p$.

`\begin{proof}`
Write $|K(x,y)|=|K(x,y)|^{1/q}|K(x,y)|^{1/p}$, then we have

$$
\begin{aligned}
\int_Y|K(x, y) f(y)| d \nu &=\int_Y|K(x,y)|^{1/q}(|K(x,y)^{1/p}|f(y)||)\\
& \leqslant\left(\int_Y|K(x, y)| d \nu\right)^{1 / q}\left(\int_Y|K(x, y)||f(y)|^p d \nu\right)^{1 / p} \\
& \leqslant C^{1 / q}\left(\int_Y|K(x, y)||f(y)|^p d \nu\right)^{1 / p}.
\end{aligned}
$$

By [[MATH/测度论/Nodes/11 Product measures, Tonelli, Fubini theorems#^67db20\|#^67db20]] we have

$$
\begin{aligned}
\int_X\left(\int_Y|K(x, y) f(y)| d \nu\right)^p d \mu & \leqslant C^{p / q} \int_X \int_Y|K(x, y)||f(y)|^p d \nu d \mu \\
& \leqslant C^{(p / q)+1} \int_Y|f(y)|^p d \nu
\end{aligned}
$$

and we finish the proof. Also see [[Measure  Theory    (Xia).pdf#page=82&selection=225,0,226,2|here]].
`\end{proof}`


The following theorem is a generalization of Minkowski's inequality, which replace $\sum$ as $\int$. 

> [!theorem]
> Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be $\sigma$-finite measure spaces, and let $f$ be a nonnegative $\mathcal{A} \otimes \mathcal{B}$-measurable function on $X \times Y$. If $1 \leq p<\infty$, then
> 
> $$\left[\int_X\left(\int_Y f(x, y) d \nu\right)^p d \mu\right]^{1 / p} \leq \int_Y\left(\int_X f(x, y)^p d \mu\right)^{1 / p} d \nu .$$

`\begin{proof}`
If $p=1$, it follows from Tonelli's theorem. If $1<p<\infty$, let $q$ be the conjugate exponent to $p$ and suppose $g \in L^q(\mu)$. WLOG assume the right hand side is finite. Then by Tonelli's theorem and Holder's inequality, we have

$$
\begin{aligned}
\int_X\left(\int_Y f(x, y) d \nu\right)|g(x)| d \mu & =\int_Y\left(\int_X f(x, y)|g(x)| d \mu\right) d \nu \\
& \leqslant\|g\|_{q} \int_Y\left(\int_X f(x, y)^p d \mu\right)^{1 / p} d \nu<\infty
\end{aligned}
$$

So the map $T: L^*(\mu) \rightarrow \mathbb{R}$ defined by

$$T(g)=\int_X\left(\int_Y f(x, y) d \nu\right) g(x) d \mu$$

is a well-defined (i.e., the integral over with respect to $d \mu$ is defined), bounded linear functional on $L^9(\mu)$, and

$$\|T\| \leqslant \int_Y\left(\int_X f(x, y)^P d \mu\right)^{1 / p} d \nu .$$

On the other hand, it follows from [[MATH/测度论/Nodes/9 LP Spaces#^on15z3\|the Riesz representation theorem]] that

$$\|T\|=\left(\int_X\left(\int_Y f(x, y) d \nu\right)^p d \mu\right)^{1 / p}$$

Now we finish the proof.
`\end{proof}`

**Remark.** 用了 Riesz representation theorem. 右边凑一个 Holder 比较容易想到，左边是线性变换的模长就有点变态了。

